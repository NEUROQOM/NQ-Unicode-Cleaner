<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NQ - Unicode Zeichen Analysator & Entferner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Lato:ital,wght@0,400;0,500;0,700;1,400;1,500;1,700&display=swap">
    <style>
        /* --- NEUROQOM-Design --- */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
        }
        .font-lato { font-family: 'Lato', sans-serif; }
        .nq-dark { color: #2c3e50; }
        .nq-teal { color: #1abc9c; }
        .bg-nq-teal { background-color: #1abc9c; }
        .hover-bg-nq-teal-darker:hover { background-color: #16a085; }
        .focus-ring-nq-teal:focus-visible {
            outline: 2px solid transparent;
            outline-offset: 2px;
            box-shadow: 0 0 0 3px rgba(26, 188, 156, 0.5);
        }

        /* --- Tooltip-Styles (soscisurvey-Style) --- */
        .S2Tooltip.anchor {
            position: relative;
            color: inherit;
            background-color: transparent;
            cursor: default;
            display: inline-block;
        }
        .S2Tooltip.container {
            position: absolute;
            z-index: 9999;
            visibility: hidden;
            pointer-events: none;
            width: auto;
        }
        .S2Tooltip.anchor:hover > .S2Tooltip.container {
            visibility: visible;
            left: 50%;
            bottom: 100%;
            transform: translateX(-50%) translateY(-8px);
        }
        .S2Tooltip.tiptext {
            padding: 0.5em 0.8em;
            color: black;
            background-color: #DDDDFF;
            border: 1px solid #9999FF;
            font-weight: normal;
            text-align: left;
            white-space: nowrap;
            display: block;
            text-indent: 0;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* Stile für spezielle Symbole in der Analyse */
        .symbol {
            color: white;
            background-color: #64748b;
            padding: 0.1em 0.3em;
            margin: 0 1px;
            border-radius: 3px;
            font-weight: bold;
        }
        .hex {
            color: black;
            background-color: #a5b4fc;
            padding: 0.1em 0.3em;
            margin: 0 1px;
            border-radius: 3px;
            font-weight: bold;
        }

        /* --- Analyse-Container --- */
        #analysisOutput {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Menlo', 'Consolas', monospace;
            font-size: 0.9em;
            line-height: 1.8;
            background-color: #f8fafc;
            border: 1px solid #cbd5e1;
            border-radius: 0.5rem;
            padding: 1rem;
            min-height: 8rem;
            overflow-x: auto;
        }
    </style>
</head>
<body class="flex items-center justify-center p-4">
    <div class="bg-white p-6 sm:p-8 rounded-xl shadow-2xl w-full max-w-3xl">
        <header class="mb-6 sm:mb-8 text-center">
            <img src="NQ - Logo-neu-transparent (3).png" alt="NEUROQOM Logo" class="h-12 sm:h-16 mx-auto mb-4" id="logoImage" onerror="this.style.display='none'; if(document.getElementById('textLogo')) document.getElementById('textLogo').style.display='block';">
            <div id="textLogo" style="display:none;" class="text-4xl sm:text-5xl font-bold mb-2">
                <span class="nq-dark">NEURO</span><span class="nq-teal">QOM</span>
            </div>
            <h1 class="text-2xl sm:text-3xl font-semibold text-slate-700 font-inter">NQ - Unicode Zeichen Analysator & Entferner</h1>
            <p class="text-slate-500 mt-2 text-sm sm:text-base font-inter">Analysiert, visualisiert und bereinigt Texte von problematischen Unicode-Zeichen.</p>
        </header>

        <main>
            <div class="mb-4">
                <div class="flex justify-between items-center mb-1">
                    <label for="inputText" class="block text-sm font-medium text-slate-700 font-inter">Text eingeben:</label>
                    <button id="clearInputButton" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-600 font-medium py-1 px-3 rounded-md transition-colors duration-150 ease-in-out font-inter focus-ring-nq-teal">Eingabe löschen</button>
                </div>
                <textarea id="inputText" rows="6" class="w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus-ring-nq-teal transition-shadow font-inter" placeholder="Fügen Sie hier Ihren Text ein..."></textarea>
            </div>

            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">
                <button id="analyzeAndCleanButton" class="w-full sm:w-auto bg-nq-teal hover-bg-nq-teal-darker text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:shadow-lg transition-all duration-150 ease-in-out transform hover:scale-105 focus-ring-nq-teal font-inter">Text analysieren & bereinigen</button>
                <div class="S2Tooltip anchor">
                    <span class="text-sm text-slate-500 cursor-default flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-1 text-slate-400" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"/>
                        </svg>
                        Welche Zeichen werden entfernt/analysiert?
                    </span>
                    <div class="S2Tooltip container">
                        <span class="S2Tooltip tiptext">Entfernt: Problematische Unicode-Zeichen (außer Zeilenumbrüche &amp; Tabs).<br>Visualisiert: Alle Zeichen mit Dezimal/Hex-Codes bei Hover.</span>
                    </div>
                </div>
            </div>

            <div class="mb-6">
                <label class="block text-sm font-medium text-slate-700 mb-1 font-inter">Analyse der Unicode-Zeichen (Original mit Hervorhebungen):</label>
                <div id="analysisOutput">Die Analyse erscheint hier...</div>
            </div>

            <div>
                <label for="outputText" class="block text-sm font-medium text-slate-700 mb-1 font-inter">Bereinigter Text:</label>
                <textarea id="outputText" rows="6" class="w-full p-3 border border-slate-300 rounded-lg shadow-sm bg-slate-50 focus:ring-2 focus-ring-nq-teal transition-shadow font-inter" readonly placeholder="Der bereinigte Text erscheint hier..."></textarea>
            </div>

            <div class="mt-4 text-center">
                <button id="copyButton" class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-medium py-2 px-4 rounded-lg transition-colors duration-150 ease-in-out text-sm font-inter focus-ring-nq-teal">Ergebnis kopieren</button>
                <p id="copyMessage" class="text-sm text-green-600 mt-2 h-5 font-inter"></p>
            </div>

            <p class="text-xs text-slate-400 mt-6 mb-6 text-center font-inter">Dieses Tool funktioniert vollständig in Ihrem Browser. Es werden keine Daten an einen Server gesendet.</p>
        </main>

        <footer class="pt-6 border-t border-slate-200 text-center">
            <p class="text-sm font-lato font-medium italic nq-teal mb-2">Identität zuerst. Strategie folgt.</p>
            <p class="text-xs text-slate-500 mt-2 font-inter">&copy; <span id="currentYear">2025</span> <a href="https://neuroqom.com" target="_blank" class="nq-teal hover:underline">NEUROQOM</a>. Alle Rechte vorbehalten.</p>
            <div class="mt-2 text-xs text-slate-500 font-inter">
                <a href="https://neuroqom.com/impressum" target="_blank" class="nq-teal hover:underline">IMPRESSUM</a>
                <span class="mx-1">|</span>
                <a href="https://neuroqom.com/datenschutz" target="_blank" class="nq-teal hover:underline">DATENSCHUTZ</a>
            </div>
        </footer>
    </div>

    <script>
        const inputText       = document.getElementById('inputText');
        const outputText      = document.getElementById('outputText');
        const analyzeBtn      = document.getElementById('analyzeAndCleanButton');
        const copyBtn         = document.getElementById('copyButton');
        const copyMsg         = document.getElementById('copyMessage');
        const clearInputBtn   = document.getElementById('clearInputButton');
        const analysisOutput  = document.getElementById('analysisOutput');
        const currentYearSpan = document.getElementById('currentYear');
        const logoImage       = document.getElementById('logoImage');
        const textLogo        = document.getElementById('textLogo');

        (function() {
            if (currentYearSpan) {
                currentYearSpan.textContent = new Date().getFullYear();
            }
            if (analysisOutput) {
                analysisOutput.innerHTML = 'Die Analyse erscheint hier...';
            }
            if (logoImage) {
                logoImage.addEventListener('error', function () {
                    logoImage.style.display = 'none';
                    if (textLogo) textLogo.style.display = 'block';
                });
            }
        })();

        const problematicCharsRegexForRemoval = /[\u0000-\u0008\u000B-\u000C\u000E-\u001F\u007F-\u009F\u00A0\u00AD\u200B-\u200F\u2012-\u2015\u2028-\u202E\u2060-\u206F\u2190-\u21FF\u27F5-\u27FF\u2E3A-\u2E3B\uFEFF]/g;

        function escapeHtml(str) {
            return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '&#039;');
        }

        function visualizeText(text) {
            if (!analysisOutput) return;
            let html = '';
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                const code = char.charCodeAt(0);
                const hex = code.toString(16).toUpperCase().padStart(4, '0');

                let displayChar = escapeHtml(char);
                let charClass = 'S2Tooltip anchor';

                if (char === '\r') {
                    displayChar = 'CR';
                    charClass = 'symbol S2Tooltip anchor';
                } else if (char === '\n') {
                    displayChar = 'LF';
                    charClass = 'symbol S2Tooltip anchor';
                } else if (char === '\t') {
                    displayChar = '→';
                    charClass = 'symbol S2Tooltip anchor';
                } else if (char === ' ') {
                    displayChar = '·';
                    charClass = 'symbol S2Tooltip anchor';
                } else if (problematicCharsRegexForRemoval.test(char)) {
                    displayChar = `U+${hex}`;
                    charClass = 'hex S2Tooltip anchor';
                    problematicCharsRegexForRemoval.lastIndex = 0;
                }

                html += `<span class="${charClass}">${displayChar}<div class="S2Tooltip container"><span class="S2Tooltip tiptext">${code}<br>0x${hex}</span></div></span>`;

                if (char === '\n') {
                    html += '<br>';
                }
            }
            analysisOutput.innerHTML = html || 'Die Analyse erscheint hier...';
        }

        analyzeBtn.addEventListener('click', () => {
            const raw = inputText.value;
            visualizeText(raw);
            const cleaned = raw.replace(problematicCharsRegexForRemoval, '');
            outputText.value = cleaned;
            if (copyMsg) copyMsg.textContent = '';
        });

        copyBtn.addEventListener('click', () => {
            if (!outputText.value) {
                if (copyMsg) {
                    copyMsg.textContent = 'Nichts zu kopieren.';
                    copyMsg.classList.add('text-red-600');
                    setTimeout(() => { if (copyMsg) copyMsg.textContent = ''; }, 3000);
                }
                return;
            }
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = outputText.value;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            try {
                document.execCommand('copy');
                if (copyMsg) {
                    copyMsg.textContent = 'Text in die Zwischenablage kopiert!';
                    copyMsg.classList.remove('text-red-600');
                    copyMsg.classList.add('text-green-600');
                }
            } catch (err) {
                console.error('Copy to clipboard failed:', err);
                if (copyMsg) {
                    copyMsg.textContent = 'Kopieren fehlgeschlagen.';
                    copyMsg.classList.add('text-red-600');
                }
            } finally {
                document.body.removeChild(tempTextArea);
            }
            if (copyMsg) {
                setTimeout(() => { if (copyMsg) copyMsg.textContent = ''; }, 3000);
            }
        });

        clearInputBtn.addEventListener('click', () => {
            inputText.value = '';
            outputText.value = '';
            if (analysisOutput) analysisOutput.innerHTML = 'Die Analyse erscheint hier...';
            if (copyMsg) copyMsg.textContent = '';
            inputText.focus({ preventScroll: true });
        });
    </script>
</body>
</html>
